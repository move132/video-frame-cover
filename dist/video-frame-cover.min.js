!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.VideoFrameCover=t():e.VideoFrameCover=t()}(self,(function(){return e={497:function(e,t,i){var o,n,r;function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}r=function(){var e=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e);var i=t.url,o=t.currentTime,n=void 0===o?1:o,r=t.quality,s=t.imgWidth,c=t.imageType,u=t.isCheckBackgroundColor,h=t.success;i||console.warn("视频链接不能为空"),this.url=i,this.video=null,this.videoWidth=0,this.imageType=c||"image/jpeg",this.quality=r?r>.2?r:.2:.95,this.imgWidth=s,this.currentTime=n<1?1:n,this.isCheckBackgroundColor=u,this.duration=0,this.success=h,this.getVideoFrame()}var t,i;return t=e,(i=[{key:"getVideoFrame",value:function(){var e=this,t=this.video||document.createElement("video"),i=this.currentTime;t.src=this.url,t.style.cssText="position: fixed; top: -100%; left: -100%; width: 400px; display: none; visibility: hidden;",t.controls="controls",t.crossOrigin="Anonymous",t.currentTime=i,t.addEventListener("timeupdate",(function(){e.setVideoInfo(),e.currentTime<=e.duration?e.generateCanvas():e.nextFrame()})),this.video=t,document.body.appendChild(t)}},{key:"setVideoInfo",value:function(){var e=this.video;this.videoWidth=e.videoWidth,this.videoHeight=e.videoHeight,this.duration=Math.floor(e.duration||0)}},{key:"appointFrame",value:function(e){if(this.video){var t=this.duration;e=e>t?t:e,this.currentTime=e,this.video.currentTime=e}else console.warn("请先初始化")}},{key:"previousFrame",value:function(){var e=this.currentTime;0!==this.currentTime&&(e--,this.appointFrame(e))}},{key:"nextFrame",value:function(){var e=this.duration,t=this.currentTime;this.currentTime!==e&&(t++,this.appointFrame(t))}},{key:"generateCanvas",value:function(){var e=this.canvas||document.createElement("canvas"),t=e.getContext("2d",{alpha:!1}),i=this.imgWidth,o=this.isCheckBackgroundColor,n=this.videoWidth,r=this.videoHeight;if(this.canvas||(i&&(r=i/(n/r),n=i),e.width=n,e.height=r),t.drawImage(this.video,0,0,e.width,e.height),!o||this.checkImage(t,n,r)){var a=e.toDataURL(this.imageType,this.quality);this.success&&this.success(a,this.video)}else this.nextFrame()}},{key:"checkImage",value:function(e,t,i){for(var o=e.getImageData(0,0,t,i).data,n={},r=0,a=0,s=o.length;a<s;a+=4){var c=o.slice(a,a+4).join("");if(n[c]||(n[c]=1,r++),r>100)return!0}return!1}},{key:"base64ToBlob",value:function(e){if(e){for(var t=e.split(";base64,"),i=t[0].split(":")[1],o=window.atob(t[1]),n=o.length,r=new Uint8Array(n),a=0;a<n;++a)r[a]=o.charCodeAt(a);return new Blob([r],{type:i})}console.warn("base64不能为空")}},{key:"downloadFile",value:function(e){var t=Date.now();if(e){var i=document.createElement("a"),o=this.base64ToBlob(e);document.createEvent("HTMLEvents").initEvent("click",!0,!0),i.download=t,i.href=URL.createObjectURL(o),i.click()}else console.warn("base64不能为空")}}])&&s(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();return e},"object"===c(t)?e.exports=r():void 0===(n="function"==typeof(o=r)?o.call(t,i,t,e):o)||(e.exports=n)}},t={},function i(o){var n=t[o];if(void 0!==n)return n.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,i),r.exports}(497);var e,t}));